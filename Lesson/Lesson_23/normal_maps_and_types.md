#### Normal Maps and Types
本节中，我们主要了解一下normal map的原理、作用以及它的种类。

**Normal Mapping**
在计算机图形学的进化中，3D模型软件或者类似的软件开始支持高精度的模型，但是游戏引擎和玩游戏的硬件平台(PC等)还没有完全支持高精度的模型，这样就产生了Normal Mapping这个技术。在这个技术中，我们先在3D模型软件中先创建高精度的模型，然后我们获取这个高精度模型的法线，并且将高精度模型的法线信息都烘培到一张纹理上面。
>在高精度模型上面，我们会有很多细节的东西，例如皱纹等等。但是游戏引擎和硬件平台并不支持高精度模型（主要是开销太大），那么就将这个高精度模型上面的法线信息对应的映射到一张纹理上面。其中法线信息是向量(x,y,z)，那么映射的时候对应到纹理的R/G/B通道中。

然后在游戏中，我们使用低精度的模型，加上这个法线纹理，那么就可以实现fake版本的光照信息，从而产生高精度模型中的细节而不提高模型的精度。如果场景中没有光照信息，那么normal map实际上是没有任何作用的。

---
**Types of Normal-maps**
现在我们来了解一下Normal-maps的类型。

在坐标系的章节中，我们知道有很多个坐标系，其中有:
>1. World Space 世界坐标系
2. Object  Space 本地坐标系

1. World Space 世界坐标系
```
如果在世界坐标系中烘培这个Normal Map，那么这个法线贴图就称为世界坐标系法线贴图。
但是在这个情况下会有很多的问题：
    1.模型必须放置在烘培法线的时候的位置
    2.模型必须是static的
只有在这个两种情况下，才能使用world space normal map
```
2. Object Space 本地坐标系
```
首先在本地模型坐标系下面烘培法线贴图，然后在使用的时候将本地的法线
转换到世界坐标系下面，然后在fragment shader中使用。但是还是有一定
的问题：
    1. 当这个模型发生形变的时候，那么这个模型中的面的法线就会变化，
    但是在本地坐标系中，我们无法在形变中来计算法线。
```

3. Tangent Space Normal Map
首先，需要理解什么是Tangent Space（切线空间），切线控制跟UV空间很相似，但是切线空间是一个3D的空间。假设我们有一个平面，UV空间中U和V就表示平面的两个方向的延展。而切线空间是3个正交向量的组合空间。
> 首先是传过中心点垂直于平面的法线
> 然后是切线向量，切线向量是正交于法线的并且一直都是在U轴方向
> 最后是副法线向量，它在V轴方向并且跟法线和切线都正交。

这3个向量组成的空间就成为切线空间，其中，与世界空间相互转换的矩阵被称为TBN矩阵：
$$
\left[
\begin{matrix}
T_x & T_y & T_z \\\
B_x & B_y & B_z \\\
N_x & N_y & N_z
\end{matrix}
\right]
$$
>我们使用法线来计算切线，然后使用法线和切线来计算副法线。他们3个相互正交。
